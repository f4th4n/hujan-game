const config={debug:!1},helper={virtual:{width:480,height:270},zOrder:{zero:0,low:1,medium:5,high:10},insideFBIframe:()=>{try{return window.self!==window.top}catch(e){return!0}}},event=new Event("model");var model={data:{bg:null}};const resource={img:{bg:"assets/img/bg.png",flower1:"assets/img/flower_1.png",cloud:"assets/img/cloud.png",ground:"assets/img/ground.png"},fonts:{pou:{type:"font",name:"Pou",srcs:["dist/fonts/Pou-RMR6.ttf"]}},particles:{rain:"assets/particle_rain.plist"},preload:{}};resource.preload={homeScene:[],playScene:[resource.img.bg,resource.img.flower1,resource.img.cloud,resource.img.ground,resource.fonts.pou,resource.particles.rain]};const LayersPlayBg=cc.Layer.extend({ctor:function(){this._super(),this.printBg()},printBg:function(){const e=new cc.Sprite(resource.img.bg);e.setAnchorPoint(0,0),e.scaleX=20,model.data.bg=e,this.addChild(e,helper.zOrder.low)}}),LayersPlayLevel=cc.Layer.extend({plants:[],ctor:function(){this._super();const e=this.printCloud();this.printRaindrop(e),this.printPlants(),this.printLabels()},printCloud:function(){const e=cc.Sprite.create(resource.img.cloud);e.setAnchorPoint(0,0),e.setScale(.2),e.setPosition(0,.8*cc.director.getWinSize().height),this.addChild(e,helper.zOrder.medium);PubSub.subscribe("MOVE CLOUD",(t,r)=>{cc.moveBy(.5,cc.p(r,e.y));e.runAction(cc.sequence(moveToTopEaseIn))});return e},printRaindrop:function(e){const t=cc.ParticleSystem.create(resource.particles.rain);t.setPosition(e.width/2,.35*e.height*-1),t.setAnchorPoint(0,0),t.setDrawMode(cc.ParticleSystem.TEXTURE_MODE),t.setBlendFunc(cc.BlendFunc.ALPHA_PREMULTIPLIED),window.particleRain=t,e.addChild(t,helper.zOrder.low)},printPlants:function(){if(0===model.data.bg.height)return setTimeout(()=>this.printPlants(),5);const e=cc.Sprite.create(resource.img.flower1);e.setAnchorPoint(0,0),e.setPosition(.1*cc.director.getWinSize().width,model.data.bg.y+model.data.bg.height),e.setScale(.2),this.addChild(e,helper.zOrder.medium)},printLabels:function(){const e=cc.LabelTTF.create("Hujan",resource.fonts.pou.name,24);e.setPosition(.01*cc.director.getWinSize().width,cc.director.getWinSize().height-.01*cc.director.getWinSize().height),e.setColor("black"),e.setAnchorPoint(0,1),this.addChild(e,helper.zOrder.medium)}}),layers={play:{Bg:LayersPlayBg,Level:LayersPlayLevel}},HomeScene=cc.Scene.extend({onEnter:function(){this._super()}}),PlayScene=cc.Scene.extend({onEnter:function(){this._super(),this.createLayers(),this.addListener()},createLayers:function(){this.addChild(new layers.play.Bg,helper.zOrder.low),this.addChild(new layers.play.Level,helper.zOrder.medium),window.f=this},addListener:function(){const e=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e,t){return PubSub.publish("MOVE CLOUD",e.getLocationX()),!0},onTouchMoved:function(e,t){PubSub.publish("MOVE CLOUD",e.getLocationX())}});cc.eventManager.addListener(e,this)}}),app={startGame:()=>{}};app.startGame=()=>{cc.game.run("gameCanvas",async()=>{cc.loader.onProgress=function(e,t,r){const n=100*e/t;console.log("progress",n),helper.insideFBIframe()&&FBInstant.setLoadingProgress(n)},cc.director.setDisplayStats(config.debug),helper.insideFBIframe()&&await FBInstant.initializeAsync(),cc.sys.isMobile&&cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE),cc.sys.isBrowser&&cc.sys.os===cc.sys.OS_ANDROID&&(cc.macro.DOWNLOAD_MAX_CONCURRENT=2),cc.LoaderScene.preload(resource.preload.playScene,(async function(){helper.insideFBIframe()&&await FBInstant.startGameAsync(),cc.director.runScene(new PlayScene)}),this)})},window.onload=app.startGame;